# Practical Malware Analysis Lab01-01.exe Walk Through

## VirusTotal Report

* All kinds of Trojan gens
* Win32.Malware gen(of course)

## When were the files compiled

* 2010/12/19 UTC

## Packed or obfuscated

*PEview*

### Lab01-01.exe


<table>
  <thead>
    <tr>
      <th> </th>
      <th>.text</th>
      <th>.rdata</th>
      <th>.data</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Virtual Size</td>
      <td>0x970</td>
      <td>0x2b2</td>
      <td>0xfc</td>
    </tr>
  </tbody>
  <tbody>
    <tr>
      <td>Size of Raw Data</td>
      <td>0x1000</td>
      <td>0x1000</td>
      <td>0x1000</td>
    </tr>
  </tbody>
</table>

### Lab01-01.dll

<table>
  <thead>
    <tr>
      <th> </th>
      <th>.text</th>
      <th>.rdata</th>
      <th>.data</th>
      <th>.reloc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Virtual Size</td>
      <td>0x39e</td>
      <td>0x23fc6</td>
      <td>0x6c</td>
      <td>0x204</td>
    </tr>
  </tbody>
  <tbody>
    <tr>
      <td>Size of Raw Data</td>
      <td>0x1000</td>
      <td>0x24000</td>
      <td>0x1000</td>
      <td>0x1000</td>
    </tr>
  </tbody>
</table>

I think it is not packed/obfuscated

And from *PEiD* also not packed

## Dependency Walker

*Meaningful dependency*

### KERNEL32.DLL

* CheckRemoteDebuggerPresent (check if a(self) process is being debugged)
* ConnectNamedPipe (create a server pipe for interprocess communication that will wait for a client pipe to connect)
* CreateFile (Creates or opens a file or I/O device.)
* CreateFileMapping (loads a file into memory and makes it accessible via memory address. Launchers, loaders and injectors use this function to read and modify PE files)
* CreateProcess
* CreateRemoteThread
* DeviceIoControls
* FindFirstFile/FindNextFile
* FindResource
* GetModuleFilename
* GetModuleHandle
* GetProcAddress
* GetStartupInfo
* GetSystemDefaultLangId
* GetTempPath
* GetThreadContext
* GetTickCount
* GetVersionEx
* GetWindowsDirectory
* IsDebuggerPresent
* IsWoW64Process
* LoadResource
* MapViewOfFile
* OpenMutex
* OpenProcess
* OutputDebugString
* PeekNamedPipe
* Process32First/Process32Next
* QueryPerformanceCounter
* QueueUserAPC
* ReadProcessMemory
* ResumeThread
* SetFileTime
* SuspendThread
* Thread32First/Thread32Next
* Toolhelp32ReadProcessMemory
* VirtualAllocEx
* VirtualProtectEx
* WideCharToMultiByte
* WinExec
* WriteProcessMemory
* SetThreadContext

It is a Trojan virus, inject into thread and write into files and try to erase the trace also with connection to hacker's computer to transform data back

## Strings

Honestly I tried to run it on my WindowsXP VM not Nothing seems happend...

Here is part of result from `strings Lab01-01.exe` 

```
C:\windows\system32\kerne132.dll
Kernel32.
Lab01-01.dll
C:\Windows\System32\Kernel32.dll
```

And from `strings Lab01-01.dll` 

```
127.26.152.13
```

So I guess it will write a `kerne132.dll` and hmm wake `Lab01-01.dll` then open a back door to the special ip??

That's the story line I guess