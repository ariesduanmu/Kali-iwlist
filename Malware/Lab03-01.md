# Practical Malware Analysis Lab03-01.exe Walk Through

## Basic Information

* 2008/01/06 UTC


## PEiD

* PEncrypt 3.1 Final -> junkcode

so it is encrypted

## Dependency Walker

* ExitProcess

## Strings

*something interesting*

* SOFTWARE\Classes\http\shell\open\commandV
* Software\Microsoft\Active Setup\ Installes Components
* test
* admin
* VideoDriver
* WinVMX32
* vmx32to64.exe
* SOFTWARE\Microsoft\Windows\CurrentVersion\Run
* SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders
* AppData

# Dynamic Analysis

## Process Monitor

* Create an interesting file `C:\WINDOWS\system32\vmx32to64.exe` (CreateFile, WriteFile, CloseFile) (This appears in strings too)

* And another `C:\\WINDOWS\system32\mswsock.dll` (there is anothe operation on it CreateFileMapping, QueryStandardInformationFile, and LoadImage, Because it is dll file?)

* `C:\Windows\system32\hnetcfg.dll`
* `C:\Windows\system32\dnsapi.dll`
* and some other dll I think not important all these `dll`
* then capture Lots TCP Connection and TCP Disconnection

## ApateDNS and NETCAT and W

* redirect all requests back to `127.0.0.1` using ApateDNS
* So I captured LOTS requests to this `www.pracricalmalwareanalysis.com`(also appears in strings), and the request frequence is 1 min
* But my netcat didn't capture anything in port 80 and got junks on port 443
* wireshark all TCP connection

## Regshot

values added: 1 
HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\VideoDriver:

Values modified: 3 
HKLM\SOFTWARE\Microsoft\Cryptography\RNG\Seed: 

